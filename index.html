<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survivor Core - Auto Aim</title>
    <style>
        body { margin: 0; background: #121212; overflow: hidden; color: white; font-family: sans-serif; }
        canvas { display: block; background: #1a1a1a; }
        #stats { position: absolute; top: 10px; left: 10px; pointer-events: none; }
    </style>
</head>
<body>

    <div id="stats">
        Kills: <span id="kills">0</span>
    </div>
    <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const player = {
    x: canvas.width / 2,
    y: canvas.height / 2,
    size: 20,
    speed: 3,
    emoji: "ðŸ§™",
    lastShot: 0,
    shotInterval: 800 // ms
};

const enemies = [];
const bullets = [];
let kills = 0;
const keys = {};

// Input listeners
window.addEventListener('keydown', e => keys[e.code] = true);
window.addEventListener('keyup', e => keys[e.code] = false);

class Enemy {
    constructor() {
        // Spawn randomly outside the canvas view
        const side = Math.floor(Math.random() * 4);
        if (side === 0) { this.x = Math.random() * canvas.width; this.y = -50; } // Top
        else if (side === 1) { this.x = canvas.width + 50; this.y = Math.random() * canvas.height; } // Right
        else if (side === 2) { this.x = Math.random() * canvas.width; this.y = canvas.height + 50; } // Bottom
        else { this.x = -50; this.y = Math.random() * canvas.height; } // Left
        
        this.speed = 1 + Math.random() * 1;
        this.emoji = "ðŸ§Ÿ";
    }

    update() {
        // Move towards player
        const dx = player.x - this.x;
        const dy = player.y - this.y;
        const angle = Math.atan2(dy, dx);
        this.x += Math.cos(angle) * this.speed;
        this.y += Math.sin(angle) * this.speed;
    }
}

class Bullet {
    constructor(x, y, targetX, targetY) {
        this.x = x;
        this.y = y;
        const angle = Math.atan2(targetY - y, targetX - x);
        this.speed = 7;
        this.dx = Math.cos(angle) * this.speed;
        this.dy = Math.sin(angle) * this.speed;
    }
    update() {
        this.x += this.dx;
        this.y += this.dy;
    }
}

function getNearestEnemy() {
    if (enemies.length === 0) return null;
    return enemies.reduce((nearest, enemy) => {
        const dist = Math.hypot(enemy.x - player.x, enemy.y - player.y);
        if (dist < nearest.dist) return { enemy, dist };
        return nearest;
    }, { enemy: null, dist: Infinity }).enemy;
}

function spawnEnemy() {
    if (enemies.length < 50) enemies.push(new Enemy());
}

setInterval(spawnEnemy, 1000);

function gameLoop(time) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 1. Move Player
    if (keys['ArrowUp'] || keys['KeyW']) player.y -= player.speed;
    if (keys['ArrowDown'] || keys['KeyS']) player.y += player.speed;
    if (keys['ArrowLeft'] || keys['KeyA']) player.x -= player.speed;
    if (keys['ArrowRight'] || keys['KeyD']) player.x += player.speed;

    // 2. Auto-Shoot Nearest
    if (time - player.lastShot > player.shotInterval) {
        const target = getNearestEnemy();
        if (target) {
            bullets.push(new Bullet(player.x, player.y, target.x, target.y));
            player.lastShot = time;
        }
    }

    // 3. Draw & Update Bullets
    bullets.forEach((b, i) => {
        b.update();
        ctx.fillStyle = "yellow";
        ctx.beginPath();
        ctx.arc(b.x, b.y, 4, 0, Math.PI*2);
        ctx.fill();
        if (b.x < 0 || b.x > canvas.width || b.y < 0 || b.y > canvas.height) bullets.splice(i, 1);
    });

    // 4. Draw & Update Enemies
    enemies.forEach((en, i) => {
        en.update();
        ctx.font = "24px serif";
        ctx.fillText(en.emoji, en.x, en.y);

        // Collision with bullets
        bullets.forEach((b, bi) => {
            if (Math.hypot(b.x - en.x, b.y - en.y) < 20) {
                enemies.splice(i, 1);
                bullets.splice(bi, 1);
                kills++;
                document.getElementById('kills').innerText = kills;
            }
        });
    });

    // 5. Draw Player
    ctx.font = "30px serif";
    ctx.fillText(player.emoji, player.x - 15, player.y + 10);

    requestAnimationFrame(gameLoop);
}

requestAnimationFrame(gameLoop);
</script>
</body>
</html>
