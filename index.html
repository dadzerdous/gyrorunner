<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vampire Runner - The River</title>
    <style>
        body { margin: 0; background: #050505; overflow: hidden; color: white; font-family: sans-serif; touch-action: none; }
        canvas { display: block; }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; pointer-events: none; }
    </style>
</head>
<body>
    <div id="ui">
        <div style="font-size: 20px;">DISTANCE: <span id="dist">0</span>m</div>
        <div style="color: #f00;">KILLS: <span id="kills">0</span></div>
    </div>
    <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// --- Game Logic ---
let worldXOffset = 0; 
const scrollSpeed = 6; // This is the "Endless Runner" speed
let distance = 0;
let kills = 0;
let enemies = [];
let bullets = [];

// --- Input Handling ---
let touchStartX = 0;
window.addEventListener('mousedown', e => touchStartX = e.clientX);
window.addEventListener('mousemove', e => {
    if (e.buttons === 1) { // If left click is held
        let diff = e.clientX - touchStartX;
        worldXOffset -= diff * 1.5; // Moving the world away from the swipe
        touchStartX = e.clientX;
    }
});
window.addEventListener('touchstart', e => touchStartX = e.touches[0].clientX);
window.addEventListener('touchmove', e => {
    let diff = e.touches[0].clientX - touchStartX;
    worldXOffset -= diff * 1.5;
    touchStartX = e.touches[0].clientX;
});

class Enemy {
    constructor() {
        // Spawn them far at the top (ahead of the player)
        this.x = (Math.random() - 0.5) * canvas.width * 2; 
        this.y = -canvas.height; 
        this.speed = scrollSpeed + (1 + Math.random() * 3); // Faster than the scroll
        this.emoji = "ðŸ§Ÿ";
    }
    update() {
        // 1. The World Scroll (Always moving toward bottom of screen)
        this.y += scrollSpeed;
        
        // 2. The Monster's Chase (Extra speed to catch the player)
        let dx = (0 - (this.x + worldXOffset)); // 0 is player center
        let dy = (canvas.height - 150 - this.y); 
        let dist = Math.hypot(dx, dy);
        
        this.x += (dx / dist) * 2;
        this.y += (dy / dist) * 2;
    }
}

function update(time) {
    distance += Math.floor(scrollSpeed / 10);
    document.getElementById('dist').innerText = distance;

    // Manage Enemies
    if (time % 60 < 1) enemies.push(new Enemy());

    enemies.forEach((en, i) => {
        en.update();
        
        // Auto-shoot logic
        if (time % 30 < 1 && Math.hypot(en.x + worldXOffset, en.y - (canvas.height - 150)) < 400) {
           // Basic projectile spawn...
        }

        // Cleanup
        if (en.y > canvas.height) enemies.splice(i, 1);
    });

    // Simple Auto-Bullet firing at nearest
    if (time % 40 < 1 && enemies.length > 0) {
        let nearest = enemies[0];
        let minDist = Infinity;
        enemies.forEach(e => {
            let d = Math.hypot(e.x + worldXOffset, e.y - (canvas.height - 150));
            if (d < minDist) { minDist = d; nearest = e; }
        });
        bullets.push({ 
            x: 0, 
            y: canvas.height - 150, 
            tx: nearest.x + worldXOffset, 
            ty: nearest.y 
        });
    }

    bullets.forEach((b, i) => {
        let angle = Math.atan2(b.ty - b.y, b.tx - b.x);
        b.x += Math.cos(angle) * 12;
        b.y += Math.sin(angle) * 12;

        enemies.forEach((en, ei) => {
            if (Math.hypot(b.x - (en.x + worldXOffset), b.y - en.y) < 30) {
                enemies.splice(ei, 1);
                bullets.splice(i, 1);
                kills++;
                document.getElementById('kills').innerText = kills;
            }
        });
    });
}

function draw() {
    ctx.fillStyle = '#050505';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Draw Perspective Lines (Runner feel)
    ctx.strokeStyle = "#111";
    for(let i = -10; i < 10; i++) {
        ctx.beginPath();
        ctx.moveTo(canvas.width/2 + (i * 200) + worldXOffset, 0);
        ctx.lineTo(canvas.width/2 + (i * 400) + worldXOffset, canvas.height);
        ctx.stroke();
    }

    // Draw Enemies
    ctx.font = "30px serif";
    enemies.forEach(en => {
        ctx.fillText(en.emoji, (canvas.width/2) + en.x + worldXOffset, en.y);
    });

    // Draw Bullets
    ctx.fillStyle = "yellow";
    bullets.forEach(b => {
        ctx.beginPath(); ctx.arc(b.x + canvas.width/2, b.y, 4, 0, Math.PI*2); ctx.fill();
    });

    // Draw Player (Fixed at bottom)
    ctx.font = "50px serif";
    ctx.fillText("ðŸ§™", canvas.width/2 - 25, canvas.height - 120);

    requestAnimationFrame((t) => { update(t); draw(); });
}

draw();
</script>
</body>
</html>
